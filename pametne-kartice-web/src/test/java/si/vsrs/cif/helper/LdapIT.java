/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package si.vsrs.cif.helper;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.math.BigInteger;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.security.InvalidAlgorithmParameterException;
import java.security.NoSuchAlgorithmException;
import java.security.cert.CRLException;
import java.security.cert.Certificate;
import java.security.cert.CertificateException;
import java.security.cert.CertificateFactory;
import java.security.cert.X509CRL;
import java.security.cert.X509CRLEntry;
import java.util.List;
import java.util.Set;
import javax.naming.NamingException;
import javax.naming.directory.Attribute;
import javax.naming.directory.Attributes;
import java.security.cert.X509Certificate;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.ldap.core.AttributesMapper;
import org.springframework.ldap.core.ContextMapper;
import org.springframework.ldap.core.DirContextAdapter;
import org.springframework.ldap.core.LdapTemplate;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 *
 * @author andrej
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({
    //"classpath:/spring/spring-servlet_it.xml",
    //"classpath:/spring/dao-context_it.xml",
    //"classpath:/spring/dao-context_metodeTest.xml",
    //"classpath:/spring/dao-context.xml",
    //"classpath:/spring/app-context.xml",
    //"classpath:/spring/dao-context_test.xml",
    "classpath:/spring/app-context_test.xml"
})
public class LdapIT {

    @Autowired
    private LdapTemplate ldapTemplate;
    @Autowired
    private LdapTemplate ldapTemplateCertificate;
    private Set<? extends X509CRLEntry> preklicaniCertifikati;

    @BeforeClass
    public static void setUpClass() {
    }

    @AfterClass
    public static void tearDownClass() {
    }

    @Before
    public void setUp() {
    }

    @After
    public void tearDown() {
    }

    @Test
    public void testTemp() {
    }

    @Test
    public void temp() {
        //ldapTemplate.
        String mail = "marko.oman@sodisce.si";
        //String mail = "S011274";

        /* List l = ldapTemplate.search(
         "", "(&(mail=" + mail + ")(objectClass=person))",
         new AttributesMapper() {
         @Override
         public Object mapFromAttributes(Attributes atrbts) throws NamingException {
         return atrbts.toString();
         }
         });

         System.out.println("L : " + l);*/

        /* List l1 = ldapTemplate.search(
         "", "(&(mail=" + mail + ")(objectClass=person))",
         new AttributesMapper() {
         @Override
         public Object mapFromAttributes(Attributes atrbts) {
         return atrbts.get("cn");
         }
         });

         System.out.println("L1 : " + l1);
         System.out.println("==>"+l1.get(0));
         */
        String filter= "(&(mail=marko.oman@sodisce.si)(objectClass=person))";
        List<String> l2 = ldapTemplate.search(
                "", filter, new ContextMapper() {
            @Override
            public Object mapFromContext(Object o) {
                DirContextAdapter adapter = (DirContextAdapter) o;
                return adapter.getStringAttribute("cn");
            }
        });

        System.out.println("L2 : " + l2);
        System.out.println("==>"+l2.get(0));
    }

    //@Test
    public void searchLDAPCertificate() {
        String serijskaSt = "1235532114021";//"1236656814018";

        List l = ldapTemplateCertificate.search(
                "", "(&(serialNumber=" + serijskaSt + ")(objectClass=person))",
                new AttributesMapper() {
            @Override
            public Object mapFromAttributes(Attributes atrbts) throws NamingException {
                //return atrbts.toString();
                System.out.println("INFOO:" + atrbts.toString());
                return atrbts.get("userCertificate;binary");
            }
        });
        System.out.println(l.get(0));

        System.out.println("L certificate: " + l);
        if (l.isEmpty()) {
            System.out.println("Napaka pri iskanju certifikata.");
        }
        if (!l.isEmpty() && l.get(0) == null) {
            System.out.println("Certifikat je preklican.");
        }
        if (!l.isEmpty() && l.get(0) != null) {
            System.out.println("Certifikat ni preklican.");
        }
    }

    // @Test
    public void readCRL() throws MalformedURLException, IOException, CertificateException, CRLException, InvalidAlgorithmParameterException, NoSuchAlgorithmException {
        URL url = new URL("http://www.sigov-ca.gov.si/crl/sigov-ca.crl ");
        //URL url = new URL("http://www.sigen-ca.si/crl/sigen-ca.crl");

        URLConnection connection = url.openConnection();
        connection.setDoInput(true);
        connection.setUseCaches(false);
        DataInputStream inStream = new DataInputStream(connection.getInputStream());
        CertificateFactory cf = CertificateFactory.getInstance("X509");
        X509CRL crl = (X509CRL) cf.generateCRL(inStream);
        inStream.close();

        Set<? extends X509CRLEntry> preklicaniCertifikati = crl.getRevokedCertificates();
        System.out.println("SIZEEEEE:" + preklicaniCertifikati.size());

        for (X509CRLEntry entry : preklicaniCertifikati) {
            System.out.println("=======================");
            System.out.println("ISSUER:" + entry.getCertificateIssuer());
            System.out.println("SERIAL:" + entry.getSerialNumber());
            System.out.println("=======================");

            // System.out.println("==>"+entry.getSerialNumber());
            // System.out.println("==>"+entry.toString());
          /*  if(entry.getSerialNumber().toString().compareTo("00ac981def")==0){
             System.out.println("INFOOOOOOOOOO:"+entry.getRevocationDate()+","+entry.getCertificateIssuer());
             }*/
        }
    }

    // @Test
    public void testJobPreklicanih() throws Exception {
        String[] serijske = new String[]{"1235532114021", "1235514914029", "1236649214015", "1236649314018", "1236649414014", "1236649514019", "1236649614013", "1236649714018", "1236649814012", "1236650014011", "1236650214010", "1236650314015", "1236650414018", "1235540714028", "1235540014036", "1235540614025", "1236346314017", "1236346214012", "1236346114018", "1236651014015", "1235491814021", "1235520414028", "1235520714023", "1235520314025", "1236651114018", "1235509414042", "1235532214026", "1235532414025", "1235531914024", "1236651214014", "1236651314019", "1236631514011", "1236631614016", "1236386414022", "1236631714010", "1235487314022", "1235487814025", "1235487614026", "1235487714020", "1235487414027", "1235494014026", "1235494114020", "1236631814015", "1236631914018", "1236276214044", "1236632014012", "1236651414013", "1236651514018", "1236651714017", "1236651814011", "1236651914016", "1236652014019", "1236652214018", "1236652314012", "1236652514011", "1236652614016", "1236652814015", "1236652914018", "1236653014012", "1236653114017", "1236653214011", "1236653314016", "1236653414010", "1236653514015", "1236653614018", "1236653714014", "1236653814019", "1236630114018", "1236630214014", "1235412814046", "1235564214036", "1236639214017", "1235524314028", "1236639314011", "1235714714024", "1236651614012", "1235517914028", "1235517814025", "1235517714020", "1235518314026", "1235518214021", "1235531714025", "1235518414020", "1235576614021", "1235576314036", "1235884014027", "1235565314026", "1235564914028", "1235565114027", "1235565014022", "1235564814025", "1235565214021", "1235521414023", "1235521114028", "1235521314029", "1235521214024", "1235515914022", "1235715514029", "1235730014016", "1235918414011", "1236007914013", "1235729814017", "1236639614015", "1236639714018", "1236615914026", "1235515114026", "1235515014021", "1236639914019", "1236640014013", "1235515814036", "1235515714023", "1235517214036", "1235516614022", "1235516714027", "1235516914026", "1235516514036", "1235534114029", "1236640114018", "1235515614029", "1235530214029", "1235515214020", "1235515514024", "1235515414028", "1235530314023", "1235514814024", "1235531814028", "1235520514024", "1235486014025", "1235485914022", "1235508114029", "1235494514029", "1235494314028", "1235494414024", "1235481014027", "1235481114021", "1235480814028", "1235481314020", "1235936514023", "1235485714023", "1235480914024", "1235481514046", "1235481714029", "1235481814031", "1235481614032", "1235481414033", "1235494614023", "1236644514010", "1236644614015", "1236644714018", "1235161214036", "1236644814014", "1236644914019", "1236645014011", "1236645114016", "1236645214010", "1236645314015", "1236645414018", "1235706414028", "1236645514014", "1236586914028", "1235516814021", "1235552014023", "1235490814036", "1235492414027", "1235523314026", "1235490914022", "1235492514021", "1235543814025", "1235543214036", "1236648714014", "1236648814019", "1236648914013", "1236649014016", "1236649114010", "1236234914011", "1236085114015", "1235896814010", "1236074214018", "1235896714016", "1235896914015", "1236053414017", "1236476214014", "1236053514011", "1236084514018", "1236273614017", "1236407214010", "1235878714017", "1235762314011", "1235878614012", "1236054614018", "1236235614011", "1236370614013", "1236370714018", "1236371014018", "1236371114014", "1236370814012", "1236371214019", "1236370914017", "1236249814013", "1235991514024", "1236201014015", "1236067814018", "1236467614018", "1235922714028", "1236339714018", "1236360114012", "1236251414014", "1236119714017", "1236295714015", "1236459014018", "1236457114017", "1235872114018", "1234663914027", "1235872014013", "1236072714013", "1236356814018", "1235432814026", "1235432714021", "1236474114012", "1235885314024", "1236474214017", "1236251314018", "1236251214015", "1236339614013", "1236329914019", "1235736614015", "1235729914011", "1236548514018", "1235713114015", "1235713214018", "1236548614012", "1235343314036", "1236057414011", "1235518014022", "1235729714012", "1236481314027", "1234942514047", "1236340914012", "1236206614010", "1236045818018", "1236374114015", "1236374214018", "1236374014010", "1236374614018", "1236374414019", "1236374714012", "1236374514013", "1236374314014", "1236206514016", "1236327214018", "1236154114014", "1236306914011", "1236306814017", "1236068414013", "1236077014018", "1236235714016", "1236236014018", "1235491514036", "1235491414023", "1236355414016", "1236376214017", "1236354814010", "1236355614015", "1236527014015", "1235883714017", "1235919714019", "1235884014019", "1235889614014", "1235883814011", "1235919414015", "1235563614030", "1236275114011", "1235884114013", "1235883514018", "1235883614012", "1235762514010", "1236150514018", "1235919314010", "1236275314010", "1235883914016", "1235919514018", "1235563614022", "1236275414015", "1236094214014", "1235538814017", "1235539614011", "1235539314018", "1235538714012", "1235539014014", "1235539214013", "1235881814014", "1235538614018", "1235621114019", "1235547214014", "1235539714024", "1235539414012", "1236244414017", "1235710914010", "1235881714018", "1235547314019", "1235539514017", "1235623914020", "1236444314017", "1236244214018", "1236053314012", "1236054114017", "1235476518084", "1236620314010", "1236297918017", "1236083214012", "1236411114012", "1236411514010", "1236273718017", "1236459614017", "1236449014011", "1236298018018", "1236253618016", "1236126818014", "1236297818012", "1236308118018", "1236239318018", "1236083614010", "1236298718011", "1236250118012", "1236083514016", "1236298218019", "1236323214015", "1236239118019", "1236530114012", "1236238514018", "1236303814016", "1236303714011", "1236238414013", "1236051514022", "1236329414016", "1236329514010", "1235519914027", "1236376314011", "1236355114012", "1236355514010", "1236269114018", "1236355814014", "1236390914013", "1236355014018", "1236354914015", "1236355214017", "1236354714016", "1236355314011", "1236355714018", "1236490618012", "1236168118012", "1236145418019", "1236530214017", "1236303018015", "1236287418016", "1236126918019", "1236298518012", "1236083314017", "1236490214019", "1236191918018", "1236299018013", "1236410714016", "1236083414011", "1235942814020", "1236123218016", "1236259818017", "1236295018019", "1236415318011", "1236083014013", "1236442614013", "1236259718012", "1236298418018", "1236259918011", "1236287018018", "1236250218017", "1236193818010", "1236145618018", "1236490314013", "1236530014018", "1236186814018", "1236457014012", "1236083114018", "1236411914019", "1236298818016", "1236298318013", "1236298918010", "1236052314019", "1236296718014", "1236533414017", "1236410914015", "1236395414019", "1236154214019", "1236370214015", "1236391114010", "1235712614022", "1236186914012", "1236555614018", "1236555718018", "1236563814018", "1236530314028", "1236571118014", "1236571714016", "1236582914017", "1236583014018", "1236237114016", "1236359914013", "1236262314011", "1236123118011", "1236450614014", "1236082914010", "1236533314012", "1236409414017", "1236239218013", "1236450514018", "1236411014018", "1236186518018", "1236453214017", "1236298118014", "1236533514011", "1236373214016", "1236530414016", "1235938014036", "1236286918015", "1236083814018", "1236298618017", "1236200714013", "1236095214018", "1236094714017", "1236095114013", "1236095014019", "1236339714026", "1236369114015", "1236287514015", "1235584014025", "1236457414010", "1236076214015", "1236076414014", "1236524314018", "1236076314018", "1235583914022", "1236587614011", "1235468714044", "1234658814022", "1236455414013", "1236455914016", "1236456514011", "1236455514018", "1236455214014", "1236455814011", "1235900814012", "1236290414013", "1235900214015", "1236455714017", "1236456414017", "1235900514019", "1236456214018", "1236455114018", "1236456114013", "1236456314012", "1235900314018", "1236455614012", "1235900114010", "1236455314019", "1236456014019", "1234658914027", "1236455014015", "1236308714018", "1235509414026", "1235941314024", "1235459614029", "1235875114019", "1236360314011", "1235875014014", "1234661614026", "1236038714012", "1236360514010", "1236279414018", "1236164414016", "1236360414016", "1236164414024", "1236357614012", "1236357514026", "1236357914016", "1236357714017", "1236235514017", "1236357814028", "1235509414034", "1236355914019", "1236165914012", "1236057914014", "1236354614011", "1236345514012", "1236075714014", "1236345214019", "1236345414018", "1236345714011", "1236068114018", "1236165814018", "1236345814016", "1236345314013", "1236068214014", "1236428014011", "1235389814025", "1236291114013", "1236345014018", "1236068014015", "1236345114014", "1236462114017", "1236118314015", "1235708014037", "1236126414010", "1235568114036", "1236390714014", "1236370014016", "1236126514015", "1236275614014", "1236370114010", "1236577914017", "1236578014018", "1236578114014", "1236322414029", "1235888014021", "1236585114011", "1235887714028", "1235393414023", "1236094814011", "1236094914016", "1235574114021", "1236267014016", "1236244014019", "1236243914016", "1236111014016", "1236509114010", "1235584914026", "1235468514029", "1235940014027", "1236007414010", "1236076514019", "1235603114036", "1236236414016", "1236066814014", "1235069914021", "1236555814019", "1236276114015", "1236362514018", "1236360914019", "1236370314018", "1236546614015", "1236363214018", "1236275814013", "1236363114013", "1236336214014", "1236491514016", "1236370514019", "1235386514020", "1236361314015", "1236361414018", "1236183414019", "1236363914018", "1236275914018", "1235386014036", "1236370414014", "1236276014010", "1236450814013", "1235333214025", "1236435614016", "1236272714018", "1236237714013", "1236435314012", "1236380314018", "1235392814044", "1236387814016", "1236295914014", "1235595114021", "1235392714023", "1236491114018", "1236436014012", "1236488914011", "1236435414017", "1236272814012", "1236361614019", "1235386614025", "1235591414020", "1236488014029", "1235491014025", "1235459414028", "1235459014021", "1235459114026", "1235459214020", "1235458114022", "1235491314029", "1235458814024", "1235458714028", "1235459714023", "1235491414031", "1235491514044", "1235492614026", "1235492314022", "1236617314018", "1236617514017", "1235459314025", "1235523414020", "1236129014013", "1234659514022", "1236356614019", "1236356314015", "1236356214010", "1236356414018", "1236340314015", "1236073514018", "1236356114016", "1236356014011", "1236356514014", "1236085014010", "1236166014015", "1236287114017", "1236368414015", "1236287214011", "1236434814011", "1236434914016", "1236435014019", "1235577714028", "1236236714018", "1236360614015", "1236360714018", "1236366314013", "1236273414018", "1236104814015", "1236435914018", "1235435514023", "1235603214022", "1236585214016", "1236585314010", "1236585414015", "1236585514018", "1236585614014", "1236593014018", "1235600614028", "1236537414011", "1235543714020", "1236384014019", "1235381614027", "1236386014016", "1235381414036", "1236465814018", "1236412614019", "1235381714021", "1236384814015", "1236531514014", "1236385614018", "1236386314018", "1236385114017", "1236386114010", "1236385814019", "1236385414010", "1236384314012", "1236461714010", "1235381814026", "1235263914024", "1236470514016", "1236412514014", "1236444814018", "1236386214015", "1236383814011", "1236386714018", "1236386514019", "1236385514015", "1236384514011", "1236465914022", "1236385714014", "1236384214018", "1236384114013", "1236386914017", "1235691514022", "1236383914016", "1236385214011", "1236384614016", "1236509214015", "1235630014027", "1236386614013", "1236384414017", "1236384914036", "1236431514017", "1236432414016", "1236432614015", "1236432114012", "1235394314022", "1236432814014", "1236436214011", "1235380314028", "1235393814021", "1236436114017", "1236433614019", "1236433714013", "1236433014011", "1235380014026", "1236431414012", "1236432914019", "1236450714027", "1236304114018", "1235435614036", "1236079914018", "1236435714010", "1236273314013", "1236273514012", "1236392414018", "1236435514011", "1235392614029", "1236273114014", "1236273214019", "1236435214018", "1236273014018", "1235687314027", "1235383814023", "1236391214015", "1235190514014", "1236452814029", "1235762014018", "1236349714016", "1235383714029", "1236348914011", "1236349214013", "1236349014014", "1236453914019", "1236454214010", "1236441314016", "1236347814013", "1236155714015", "1236428218016", "1235386914029", "1236344814012", "1236441514015", "1235395714024", "1235388514036", "1236441114017", "1236347714019", "1235388314029", "1236277014014", "1235387114026", "1236076814012", "1236400714018", "1236139614019", "1236418014013", "1236348614018", "1236516214012", "1235387214020", "1236440114013", "1236076714018", "1236348814017", "1236347014017", "1236479414014", "1236347214016", "1236489514017", "1236489614011", "1236347614014", "1236454314015", "1236081814012", "1236440214018", "1236193118019", "1236348014010", "1236441814019", "1236440514011", "1236259314019", "1235387614029", "1236274614010", "1236348214018", "1236516314017", "1235388914026", "1236076614013", "1236139314015", "1236440614016", "1236440914018", "1236348414019", "1236164614015", "1236505014011", "1236139414018", "1235387914022", "1236479514019", "1236347914018", "1236489314018", "1236299318017", "1236456814015", "1235387714023", "1236446514013", "1236081714018", "1236474814014", "1235387314025", "1236441014012", "1235389214036", "1236441214011", "1236347314010", "1235388014025", "1236505714013", "1235388414023", "1236348314014", "1235387514024", "1236441614018", "1235387414028", "1236439914014", "1236440814015", "1236489214013", "1236347514018", "1236309614019", "1236236814014", "1236193018014", "1235388114028", "1236093514014", "1235387814036", "1235388214024", "1236348714012", "1236470414011", "1236454114016", "1235399714029", "1236440014019", "1236421414014", "1236440714010", "1236516414011", "1236400814012", "1236274414011", "1236440314012", "1236347114011", "1236474514010", "1236139114016", "1236433214010", "1236433414018", "1236434014015", "1236098014018", "1235380114020", "1236433114016", "1236432214017", "1236431914015", "1236137414020", "1236433814018", "1236431814010", "1236432014018", "1235637214021", "1235558414023", "1236349314018", "1235383914036", "1236097914017", "1235762114012", "1235093814028", "1236097814012", "1235384014020", "1236349614011", "1236097714018", "1236349914015", "1236349814010", "1236349414012", "1236350014018", "1236349114019", "1236074414017", "1236437414014", "1236290614012", "1236409714010", "1236409914018", "1236507114013", "1235382214022", "1236331614014", "1236571414012", "1236578614017", "1236616514013", "1236616714012", "1236616814017", "1236617014014", "1236617214013", "1236617714016", "1236617814010", "1235624414021", "1236617914015", "1236618014018", "1236176414011", "1236236914019", "1236526414018", "1236268914010", "1235382914024", "1236434614012", "1235382814028", "1235383014027", "1236176314017", "1236436414010", "1236571814010", "1236571914015", "1236434214014", "1235334014028", "1236445714019", "1235523814029", "1236018714016", "1235382614020", "1236446014010", "1236151414017", "1235382514026", "1235382714025", "1236446114015", "1235621614011", "1236412914012", "1236452314018", "1236452114019", "1236413014015", "1236373114011", "1236452714016", "1236413414013", "1236451814017", "1236128914010", "1236451714012", "1235332814010", "1236413614012", "1235394514021", "1235472814029", "1235624914024", "1236346514016", "1235625114021", "1235524414024", "1235523914023", "1236357214014", "1236413114018", "1236452214013", "1236451914011", "1236452614011", "1235332714016", "1236452014014", "1236540614021", "1235383514028", "1236413514018", "1236452414012", "1236413214014", "1236451614018", "1236452514017", "1235415114029", "1236413314019", "1236093614019", "1236358014019", "1236440414017", "1236441714014", "1236348114015", "1236454014011", "1236548014015", "1236347414015", "1236569114018", "1236586914011", "1236588118018", "1236595714017", "1236620214016", "1236291014019", "1236405514017", "1236422014018", "1236491014013", "1236443314013", "1236290914016", "1236487714019", "1235382314027", "1236290814011", "1235382114036", "1236331414015", "1236331714019", "1236487614014", "1235382014048", "1236443414018", "1235381914020", "1236468414012", "1236290714017", "1236443214019", "1236331514018", "1236451514013", "1236451414019", "1236371414018", "1236468514017", "1236468714016", "1236371514012", "1236379814015", "1235141214038", "1236388314017", "1236388414011", "1236468614011", "1235352914028", "1235417814036", "1236263714013", "1235495414036", "1236143414016", "1236143514010", "1235891014016", "1236375614011", "1236375014014", "1236375314018", "1236375714016", "1235890314016", "1235890514015", "1234905118026", "1234905318025", "1236376114012", "1236375214013", "1235890714014", "1236375914015", "1236385314016", "1236375414012", "1236376014018", "1235890114017", "1236375514017", "1235890914013", "1236375114019", "1235890814019", "1236375814010", "1235945114011", "1235945214016", "1235890214011", "1235890414010", "1235890614018", "1235891114010", "1235945614014", "1236529414010", "1235946914011", "1235945914018", "1235947914015", "1235946214018", "1235948414016", "1235947014014", "1235948314011", "1235946714012", "1235946014010", "1235947314018", "1235946414019", "1235946314014", "1235948014018", "1236428614019", "1236539914011", "1236540114010", "1235945414015", "1235945514018", "1236529514015", "1235948514010", "1235946814017", "1236428714013", "1235948214017", "1235946514013", "1235945814013", "1235947214013", "1236296914018", "1236263314015", "1235947614011", "1235947714016", "1235945714019", "1235947414012", "1236008314018", "1236539814017", "1235948114012", "1236540014016", "1235946614018", "1235946114015", "1235947514017", "1235947114019", "1235947814010", "1235626314024", "1236191814018", "1236327014010", "1236292610022", "1236447310012", "1236472410013", "1236292710027", "1236525310016", "1236472310019", "1236472510018", "1236447410017", "1236437214015", "1236443514012", "1236304610015", "1235542814021", "1235542114028", "1235543014029", "1236261314018", "1236254614022", "1236254614014", "1235388814021", "1236304714015", "1236204810017", "1236118914012", "1235383314039", "1236092914019", "1235383414025", "1236119114018", "1236119614012", "1236119014015", "1236119314019", "1236119514018", "1236119214014", "1235873318016", "1235873218011", "1235950314010", "1235931014014", "1236650114016", "1235577614025", "1235577214027", "1235577314021", "1235577414026", "1235577114022", "1235577514020", "1236665114012", "1236665214017", "1236665314011", "1235560114029", "1235559714020", "1235560214023", "1235560014024", "1235569814023", "1235559814033", "1235573014023", "1235573414021", "1235575914021", "1235576114029", "1235576714026", "1235576514027", "1235576814020", "1235577014036", "1235576014024", "1235524014026", "1235567714021", "1235568914024", "1236666514014", "1235569514028", "1235569414025", "1235569714029", "1236666614019", "1235568614020", "1235566814022", "1235567814026", "1235567214029", "1236666714013", "1235566914027", "1235569614024", "1235567014028", "1236666814018", "1236666914012", "1236667014015", "1235536114026", "1235544514025", "1235544614028", "1235544714024", "1236667114018", "1235544214021", "1235544414020", "1236667214014", "1236667314019", "1235539714032", "1235583814036", "1235584114028", "1235584514036", "1235584614022", "1235584414023", "1235584314029", "1235583514024", "1235583414028", "1235583714023", "1235584714027", "1235584214024", "1236671714013", "1235565714024", "1235565814029", "1235566214025", "1235565514025", "1235565914023", "1235566014026", "1235531614020", "1235552914024", "1235553314020", "1235565414020", "1235553514028", "1236671914012", "1236672114018", "1235523514025", "1235540914029", "1235575414029", "1236672414013", "1236672614012", "1236672714017", "1235541514024", "1235541314025", "1235541414028", "1236359814019", "1236672814011", "1236358914018", "1236673014019", "1236673214018", "1236673314012", "1236673414017", "1235543914028", "1236673514011", "1235543614026", "1235561414026", "1235560814020", "1235561714028", "1235542014025", "1235542514036", "1235542414023", "1236654814012", "1236654914017", "1235540514020", "1235540314021", "1235540114022", "1235539814029", "1235540214027", "1235540414026", "1235576214023", "1235576414022", "1236655014018", "1236655114014", "1235560614021", "1235560714026", "1235560914025", "1235561314021", "1235560314036", "1235561114022", "1235560414022", "1235561214027", "1235580814027", "1235581214023", "1235580614036", "1235581014024", "1235581314036", "1234655714035", "1235580914021", "1235580714022", "1235581514027", "1236359614018", "1236673614016", "1235552314027", "1236673714010", "1235560514027", "1235625214026", "1236367114018", "1236367914014", "1236366814016", "1236367014013", "1236381114012", "1234661314022", "1236380814010", "1234660914026", "1236380714016", "1234661014029", "1236367414011", "1236367514016", "1236368214016", "1236367314017", "1235548914036", "1235548814023", "1235548414025", "1235548514028", "1236656014013", "1236656114018", "1236656214012", "1236656314017", "1235550414024", "1235624714025", "1236656414011", "1235549114025", "1235549514023", "1236656514016", "1235550114020", "1236656714015", "1235889714027", "1235539214021", "1235538614026", "1235539514025", "1235539614028", "1235538714020", "1235539414020", "1235547214022", "1235538814025", "1235538914028", "1235539014022", "1235539114027", "1235570014022", "1236458214023", "1236658214018", "1234653014036", "1235536014021", "1235536714023", "1235536814036", "1235536914022", "1236465814036", "1236658314014", "1236658414019", "1236658514013", "1236658614018", "1235516214024", "1235516414023", "1235519414024", "1235518614028", "1234659414036", "1235518714024", "1235519314028", "1236658714012", "1235519714036", "1235520014021", "1235519014026", "1235518914023", "1235519614023", "1235520114026", "1236657014017", "1236658814017", "1235492014029", "1236659314018", "1235562614029", "1236659414012", "1235549914021", "1235550014026", "1235550614023", "1235550714036", "1236659514017", "1235548714029", "1236659614011", "1236659714016", "1236596314020", "1235535714028", "1235535214027", "1235535114022", "1235535514020", "1235535614025", "1236380914015", "1235535414026", "1236661814018", "1236661914014", "1235887414034", "1235577714046", "1236662614014", "1236662714019", "1236662814013", "1235509314021", "1234659214029", "1236330014013", "1236663414019", "1235541214020", "1235541814036", "1235541714023", "1235541614029", "1235555514027", "1235555714026", "1235556314021", "1235556114022", "1235556214027", "1235556714028", "1235556414026", "1235556014036", "1235581814020", "1235581714026", "1235581914025", "1235581614021", "1235599614029", "1235599514024", "1235580014020", "1235579414023", "1235579714027", "1235580314024", "1235579314029", "1235579914026", "1236676314013", "1234695014044", "1235620314022", "1235624814046", "1235596114025", "1236676014018", "1235605914038", "1236362214014", "1236371714011", "1235624214022", "1235554814027", "1235555314036", "1235555114029", "1235629114026", "1236685714016", "1235563714027", "1235555014024", "1235657314022", "1235597314036", "1235620414027", "1235627514027", "1235616914023", "1236361814018", "1235628414026", "1236685814010", "1236685914015", "1236686114012", "1236686214017", "1235622214025", "1235621914023", "1235621714024", "1235622014026", "1236366214019", "1236343114017", "1236366114014", "1236686314011", "1235595614024", "1235616714024", "1236686414016", "1236686514010", "1235599914022", "1235624614020", "1235658214021", "1236262114020", "1236686614015", "1235598214027", "1236687014011", "1235597914025", "1235597414022", "1236687114016", "1235597214023", "1236686714018", "1235597714026", "1236361514014", "1235554914021", "1235627314036", "1236692714013", "1235627414022", "1235620514021", "1236692814018", "1236692914012", "1235629214020", "1236693014015", "1236693114018", "1236693214014", "1236693314019", "1236693414021", "1235597514027", "1235598814024", "1236693514018", "1235629314025", "1236693614012", "1236693714017", "1235603414021", "1235602414036", "1235601814022", "1235600714024", "1235602214029", "1235602014028", "1235602114024", "1235602314023", "1235601914027", "1236693914016", "1236694014019", "1236694114013", "1236330414011", "1236358614016", "1236358414017", "1236358114013", "1236358714010", "1235579614022", "1236681514012", "1236681614017", "1236681714011", "1236681814016", "1236681914010", "1236682014013", "1236682114018", "1235524514029", "1235571714036", "1236682214012", "1235611214023", "1235886114029", "1236682314017", "1236682414011", "1235601014026", "1235596814027", "1236682514016", "1236682614010", "1235626914021", "1235622114020", "1236343214011", "1236343614018", "1236343014012", "1236343314016", "1236343714014", "1236344514019", "1236343514015", "1236343914013", "1236344114010", "1236344414014", "1235620814025", "1235524714036", "1235636514021", "1235636214036", "1235606214023", "1235606114029", "1235580114025", "1235580414029", "1235606014024", "1235606514027", "1235621114027", "1235621014022", "1235622514029", "1235622714036", "1235622414024", "1235582014036", "1235602814026", "1235635314029", "1235601514029", "1235601614023", "1235621814029", "1235602614027", "1235603314027", "1235603514026", "1235603014023", "1235596314024", "1236677914014", "1236678014017", "1235634014021", "1236678114011", "1235622814022", "1235623014028", "1235622914027", "1236343414010", "1235561514020", "1235559914028", "1235559414027", "1235582714028", "1235582614025", "1235582814024", "1235584814021", "1235582514020", "1235582414026", "1235582314021", "1236673814015", "1235550314028", "1236673914018", "1235566114020", "1235568514026", "1235567614027", "1235567414036", "1235566414024", "1235566714036", "1235567914020", "1235599014021", "1235599114026", "1235598714028", "1236674014012", "1235552614020", "1235552514026", "1235552814028", "1235552714025", "1235553114021", "1236674114025", "1235563114028", "1235563014025", "1235562114026", "1235563814021", "1235561814024", "1235562914022", "1235562214020", "1235561914029", "1235563514036", "1235563214024", "1235564114023", "1236674214011", "1236674314016", "1236674414010", "1235623214029", "1235596914021", "1235596014020", "1235597014024", "1235597114029", "1235596214046", "1235536514024", "1235536314025", "1235571614023", "1235585114023", "1235585214036", "1235574714029", "1235575314024", "1235574514028", "1235575214028", "1235575614036", "1235574614024", "1235575014020", "1235574414025", "1235574314020", "1235574914036", "1236675214015", "1235574814023", "1235558114028", "1235558014025", "1235559314022", "1235559114023", "1235558214024", "1235558514036", "1235558814021", "1235563414023", "1235600914023", "1236675714018", "1236675814012", "1235572914020", "1235573814028", "1235573714025", "1235573314027", "1235573214022", "1235572214029", "1235574214026", "1235572314023", "1235572014028", "1235572114024", "1235572614027", "1235573914024", "1235571814022", "1235575514023", "1235573614020", "1235572814026", "1235620714020", "1235518514025", "1235595214026", "1235557214020", "1235557014021", "1235557914022", "1235557414028", "1235557514024", "1235557314025", "1236675914017", "1235595414025", "1235600014022", "1235607714028", "1235564614026", "1235559014029", "1236702014015", "1235603614020", "1235623514022", "1236702114018", "1236702214014", "1236702314019", "1236702414013", "1235618214029", "1235618514022", "1235618614027", "1235618414036", "1235617814022", "1235618314023", "1235623614027", "1235618014028", "1236702514018", "1236702714017", "1236702814011", "1236702914016", "1236703014019", "1236703114013", "1236703214018", "1236703314012", "1236703414017", "1235415814020", "1236703514011", "1236703614016", "1236703714010", "1236703914018", "1236704014012", "1236704114017", "1236704214011", "1236704314016", "1236704414010", "1235624514026", "1236704514015", "1236704614018", "1236704714014", "1235625014027", "1236382214010", "1236382814018", "1236382314015", "1236382514014", "1236381714018", "1236382714013", "1236382914012", "1236730414010", "1236730514015", "1235604214026", "1235657814025", "1235600314026", "1235662314022", "1235601314028", "1235637614028", "1236730614018", "1235625914036", "1235626114025", "1236730714014", "1236730814019", "1235662514021", "1235668714022", "1235668914021", "1235668814027", "1236731014016", "1236731114010", "1236381514010", "1236382614019", "1236381814014", "1236382414018", "1236732214019", "1236732314013", "1234663914035", "1235606614021", "1235626214028", "1235627614021", "1235629814036", "1235629914022", "1235674914025", "1235623314023", "1235636714020", "1235627914025", "1236007814027", "1235622614023", "1235623414036", "1236432514029", "1236736314018", "1236736414012", "1236738114016", "1236738214010", "1236738314015", "1235660714023", "1235623714021", "1235703114025", "1235681414028", "1235573114044", "1236739914016", "1236741314018", "1236741414012", "1236741514017", "1236741614011", "1236741714016", "1235672714029", "1236704814019", "1236704914013", "1236705014016", "1235621514025", "1235600414020", "1235492214044", "1235543514021", "1234659714038", "1236746914013", "1236747014016", "1236747214015", "1236747314018", "1236747414014", "1236747614013", "1236747714018", "1236747814012", "1236747914017", "1236748014018", "1235639214029", "1236748114014", "1236748214019", "1236748314013", "1236342514011", "1236368814013", "1236748514012", "1236748614017", "1236748714011", "1236748914010", "1236749014013", "1236749114018", "1236749214012", "1236749314017", "1236749514016", "1236749614010", "1235639014028", "1236344314018", "1235628814024", "1235628714028", "1236699614014", "1236699714019", "1235603914024", "1236699814013", "1235580514023", "1235579814021", "1236699914018", "1236700114012", "1235635114028", "1234884814035", "1235674014024", "1236700214017", "1236700314011", "1235667814023", "1235552414021", "1235599814036", "1235627814020", "1235579514036", "1236700414016", "1236700514010", "1236700614015", "1236700714018", "1236700814014", "1236700914019", "1236701014011", "1236701114016", "1235583214020", "1236701214010", "1236701314015", "1235623114024", "1235492114023", "1235885214028", "1236716814014", "1236717014011", "1235596714022", "1236717114016", "1236717214010", "1236717314015", "1236717414018", "1236717614019", "1236717714013", "1236717814018", "1236717914012", "1236718014015", "1236718214014", "1235424314022", "1236718314019", "1236718414013", "1236718614012", "1236718714017", "1236718814011", "1236718914016", "1236719014019", "1235625614024", "1236719214018", "1236719514011", "1236719614016", "1235671014023", "1235638314028", "1235671114036", "1236719714010", "1236719814015", "1236719914018", "1235195814032", "1235638414024", "1236703814015", "1235624314027", "1236720014014", "1235621314026", "1236720114019", "1235599314025", "1235602914020", "1236720214013", "1236720314018", "1236720414012", "1236720514017", "1236720614011", "1236720714016", "1236720814010", "1236720914015", "1236721014018", "1236721114012", "1234592914012", "1236721214017", "1235623814026", "1236721314011", "1236721414016", "1235639114024", "1235621214021", "1235621414020", "1236721514010", "1236721614015", "1236721714018", "1236721814014", "1235670814026", "1236729514018", "1236729614014", "1236729714019", "1236729814013", "1236729914018", "1236760914018", "1236761314014", "1235708414027", "1236369914028", "1235676014021", "1235675914029", "1235676114026", "1236795714011", "1235509514020", "1236798514013", "1236382014011", "1236383214014", "1236383114018", "1236531014028", "1235680214027", "1236799814010", "1236223714029", "1236799914015", "1236800014015", "1236800114018", "1236800214014", "1236800314019", "1235709314026", "1235719614036", "1235709214021", "1235709014022", "1235709714024", "1235709614028", "1236800414013", "1236800514018", "1236800614012", "1236800714017", "1236802714014", "1236802814019", "1235709914023", "1235889914026", "1235687614020", "1235582214027", "1234689914033", "1236752314018", "1236752414014", "1236752514019", "1236752614013", "1236752714018", "1235638714036", "1235639414036", "1236752814012", "1236752914017", "1236753014018", "1236753114014", "1236753214019", "1236753314013", "1236753514012", "1236753614017", "1236753714011", "1235638914027", "1236753814016", "1236753914010", "1236754014013", "1236754214012", "1236754414011", "1236754514016", "1236754614010", "1234658414024", "1235639314023", "1236754714015", "1236754814018", "1236754914014", "1236755014017", "1236755114011", "1235691814026", "1235691614027", "1235691714021", "1236766614016", "1235190414036", "1236763714036", "1236770314019", "1236770414013", "1236368314010", "1236372814018", "1236346814018", "1235702914036", "1235695814020", "1235703014020", "1236778314018", "1235515314025", "1236778414012", "1236778514017", "1236778614011", "1236778714016", "1236778914015", "1236779014018", "1236779114020", "1236779214017", "1236779314011", "1236779414016", "1236779514010", "1236779614015", "1236779814014", "1236779914019", "1236780014013", "1236780214012", "1236780314017", "1236386814020", "1236143314028", "1236765114018", "1236765414013", "1236765514018", "1236765614012", "1235693114021", "1235698914026", "1235699914028", "1235634414028", "1236767914013", "1235493614028", "1236768014016", "1236768114010", "1236768214015", "1236768314018", "1236768414014", "1236768514019", "1236768614013", "1236768714018", "1236768814012", "1236768914017", "1236769014018", "1236769114014", "1236769214019", "1234656614026", "1236769314013", "1236769414018", "1236769514012", "1235562014021", "1236775714015", "1235795314025", "1236784914019", "1235491614022", "1236785014011", "1236372214012", "1236371914010", "1235681514024", "1236757914015", "1236758014018", "1236758114012", "1236758214017", "1236758314011", "1236758414016", "1236758514010", "1235562314025", "1236758614015", "1236758714018", "1236758814014", "1236758914019", "1236759014011", "1236759114016", "1236759214010", "1236759314015", "1236759414018", "1236759514014", "1236759614019", "1236759814018", "1236760014017", "1236760214016", "1236760614014", "1236760714019", "1236760814013", "1236761114015", "1236372014021", "1236761214018", "1236761414019", "1236761614018", "1236761714012", "1236761914011", "1236762014014", "1236762114019", "1236436314024", "1236762414012", "1236759714013", "1236760314010", "1235338714026", "1235692714025", "1235692614020", "1235693014027", "1235638614023", "1236362314019", "1236357114018", "1236362714017", "1235583314025", "1235687414021", "1235677814021", "1235628014036", "1236773114010", "1236773914017", "1236774014018", "1236774114014", "1235913214022", "1236775014013", "1236777114015", "1235707514036", "1235681714023", "1236777614018", "1236741214021", "1236755514018", "1236755614014", "1236755714019", "1236755814013", "1236755914018", "1236756014010", "1236756114015", "1235553614024", "1235509214027", "1235707414023", "1235708114023", "1236787414017", "1235485614029", "1235714114027", "1235714214021", "1235714314026", "1235714514025", "1235714614028", "1235714914023", "1235715014026", "1235715214025", "1235715314028", "1235715414024", "1235715714036", "1235715814022", "1235715914027", "1234761114020", "1235543414027", "1236790514014", "1236749714015", "1236749814018", "1236749914014", "1236750014019", "1236750114013", "1236750214018", "1235638814022", "1236750314012", "1236750414017", "1236750614016", "1236750714010", "1235595714029", "1236750814015", "1236750914018", "1236751014012", "1236751114017", "1235636414027", "1235628914029", "1236751214011", "1236686914019", "1236754314017", "1235699114023", "1236446414027", "1235710314021", "1235710114022", "1236793014012", "1235710014036", "1235710214027", "1236794514019", "1236794614013", "1236794714018", "1235708614026", "1235708714020", "1236795414018", "1235564014029", "1236795514012", "1236803314018", "1235111714046", "1236816414013", "1236816514018", "1236816614012", "1236816714017", "1236816814011", "1236816914016", "1236817014019", "1236817114013", "1236817214018", "1236817314012", "1236817414017", "1236817514011", "1236817614016", "1236817714010", "1235626514023", "1236817814015", "1236817914018", "1236818014012", "1236818114017", "1236818214011", "1236818414010", "1236806814013", "1236807014010", "1235596614036", "1235229614028", "1236818614018", "1236819214015", "1235386214027", "1236820014011", "1236820114016", "1236820214010", "1236820314015", "1236367614010", "1236365614013", "1236361914012", "1236366714011", "1236362014015", "1236365914017", "1236365814012", "1236365714018", "1236821714017", "1236821814011", "1236372114018", "1236342614016", "1236361214010", "1236824714018", "1236150414021", "1236824814012", "1236825314013", "1235562714023", "1236825414018", "1236825514012", "1236825614017", "1236826114018", "1236826214012", "1236826314017", "1236826414011", "1236826514016", "1236826614010", "1234966714020", "1235636314022", "1235638514029", "1236828114015", "1236828214018", "1235637014022", "1236828314014", "1236828514013", "1236828614018", "1236828714012", "1236828814017", "1236828914011", "1236829014014", "1236829114019", "1236829214013", "1236829314018", "1236829414012", "1236829514017", "1236829714016", "1236829814010", "1236830214019", "1235620614026", "1236830414018", "1235577814024", "1236830614017", "1236830714011", "1236830814016", "1236831114018", "1236363614016", "1236831314017", "1236808514017", "1236808914015", "1236804314013", "1236806314010", "1236831214012", "1236831514016", "1236831414011", "1236831614010", "1236831714015", "1236831814018", "1236831914014", "1236832014017", "1236372314017", "1236616614026", "1236832214016", "1236431714024", "1236832314010", "1236832514018", "1236832414015", "1236832614014", "1236832714019", "1236832914018", "1236833014010", "1236833114015", "1236833214018", "1236833314014", "1236833414019", "1236833514021", "1235713214036", "1236342714010", "1236833614018", "1236833714012", "1236833914011", "1236368714019", "1236369414019", "1236369614018", "1236369814017", "1236368914018", "1235524614023", "1235714414020", "1236804214019", "1235718914036", "1236804414018", "1236804614017", "1236804714011", "1236804814016", "1236805114018", "1236805214012", "1236805314017", "1236805414011", "1234656314022", "1236368514018", "1236369314014", "1236369014010", "1236369514013", "1236369714012", "1236368614014", "1236369214018", "1236805814018", "1236806014017", "1235528514023", "1236806114011", "1236806214016", "1236806614014", "1236806714019", "1236616014029", "1236806914018", "1236807114015", "1236807214018", "1236807314014", "1236807414019", "1236807714012", "1236807814017", "1236807914011", "1236808014014", "1236808114019", "1236808214013", "1236808314018", "1236808414012", "1236808614011", "1236808714016", "1234946314018", "1236808814010", "1236809014018", "1236809114012", "1236809214017", "1236809314011", "1236809414016", "1236809514010", "1236809614015", "1236809714018", "1236809814014", "1236809914019", "1236810014013", "1236810114018", "1236810214012", "1236810314017", "1236810614010", "1236810714015", "1236810814018", "1236811114011", "1236811214016", "1236811314010", "1236811414015", "1236811514018", "1236811714019", "1236811814013", "1236811914018", "1236812014010", "1236812114015", "1236812214018", "1236812314014", "1236812414019", "1236812514013", "1236812614018", "1236812714012", "1234766614013", "1236812814017", "1236812914011", "1236813014014", "1236813214013", "1236804514012", "1236381914019", "1236813314018", "1236813414012", "1236813514017", "1236815614019", "1236815714013", "1236815814018", "1236815914012", "1236816014015", "1236816114018", "1236816214014", "1236816314019", "1236829614011", "1236830314013", "1235625414025", "1236862814018", "1236862914012", "1236863014015", "1236863114018", "1236863214014", "1236863314019", "1234934114021", "1236863414013", "1235637914023", "1236863614012", "1236342414017", "1236864214018", "1236864514011", "1236864614016", "1234795114054", "1236864814015", "1236864914018", "1236865014012", "1236865114017", "1235707214024", "1235736014026", "1235736114020", "1236865314016", "1236865414010", "1235730014024", "1236865714014", "1236865814019", "1236841114016", "1236866014016", "1236836114016", "1236836314015", "1236836414018", "1236836514014", "1236836614019", "1236836814018", "1236836914012", "1236837014015", "1236837114018", "1236837214014", "1236837314019", "1236837414013", "1236837514018", "1235626014020", "1236837614012", "1236837714017", "1236837814011", "1236837914016", "1236838014019", "1236838114013", "1236838314012", "1236838514011", "1236838614016", "1236838714010", "1236838814015", "1236839014012", "1236839114017", "1236839214011", "1236839314016", "1236839714014", "1236839814019", "1236839914013", "1236840114012", "1236840214017", "1236840314011", "1236840414016", "1236840514010", "1236840614015", "1236840714018", "1236840814014", "1236840914019", "1236841014011", "1236841214010", "1236841314015", "1236841414018", "1236841514014", "1236841614019", "1236841714013", "1236841814018", "1236841914012", "1236842014015", "1236842114018", "1236842314019", "1236842414013", "1236842514018", "1236842614012", "1236842714017", "1236842814011", "1236842914016", "1236843014019", "1236843114013", "1236838414017", "1236838914018", "1236839514015", "1235516014025", "1236843514011", "1236843614016", "1236433314023", "1236432714036", "1236431614028", "1236843714010", "1236844014012", "1235572714021", "1235664214025", "1235524114020", "1235734114023", "1236844114017", "1235595314020", "1236844214011", "1236847814018", "1236847914014", "1236848014017", "1236848114011", "1236848214016", "1236848314010", "1236848414015", "1236848514018", "1236848614014", "1236848714019", "1236848814013", "1236848914018", "1236849114015", "1236849214018", "1236849314014", "1236849414019", "1236849614018", "1236330814018", "1236330714015", "1236330614010", "1236850014016", "1234661714020", "1236850114010", "1236850414014", "1236834014014", "1236834114019", "1236834214013", "1236834314018", "1236834414012", "1235664314028", "1236834514017", "1235625314020", "1236834714016", "1235729914028", "1236371614017", "1236834814010", "1236834914015", "1236835014018", "1235734014029", "1236363814015", "1236835114012", "1236835214017", "1236835314011", "1236835414016", "1236835514010", "1236835614015", "1236850514019", "1236850614013", "1236850714018", "1236850814012", "1236850914017", "1236851014018", "1236851114014", "1236851214019", "1236851314013", "1236851414018", "1236851514012", "1236851614017", "1236851714011", "1236851914010", "1236852014013", "1236852114018", "1236852214012", "1236852314017", "1236852414011", "1236852514016", "1236852614010", "1236852714015", "1236852814018", "1236852914014", "1236853014017", "1236853114011", "1236853214016", "1236853314010", "1236853514018", "1236853614014", "1236853714019", "1236853814013", "1236853914018", "1236854014010", "1236854114015", "1236854214018", "1236854414019", "1236854514013", "1236854614018", "1236849014010", "1236849914011", "1236850214015", "1234632814024", "1236855214013", "1236855414012", "1236855514017", "1236855614011", "1236855714016", "1236855814010", "1236855914015", "1236856014018", "1236856114012", "1236856214017", "1236856414016", "1236856514010", "1236856614015", "1236856714018", "1235712514036", "1236856814014", "1236857014011", "1236857114016", "1236857214010", "1236857314015", "1236857414018", "1236857514014", "1236857614019", "1236857814018", "1236857914012", "1236858014015", "1236858114018", "1236858314019", "1236858414013", "1236858514018", "1236858614012", "1236858814011", "1236858914016", "1236859014019", "1236859114013", "1236859214018", "1236859414017", "1236859514011", "1236859614016", "1235629014038", "1236833814017", "1236840014018", "1236859714010", "1236859814015", "1236859914018", "1236860014014", "1236860114019", "1236860214013", "1236860314018", "1236860414012", "1236860514017", "1236860614011", "1236860714016", "1236860814010", "1236860914015", "1236861014018", "1236861214017", "1236861314011", "1235555614038", "1236861414016", "1236861714018", "1236861914019", "1236862014011", "1236862114016", "1236862214010", "1236854314014", "1236855314018", "1236857714013", "1236858214014", "1236858714017", "1236859314012", "1237014314018", "1237014414014", "1235856314023", "1236890214018", "1235743514026", "1236890314012", "1236890514011", "1235709514033", "1236890614016", "1236890714010", "1236890814015", "1236890914018", "1236891014012", "1236895514018", "1235772114029", "1236962214018", "1235516314029", "1236810514016", "1236718514018", "1236832814013", "1237160714011", "1235638114020", "1237159114019", "1236836214010", "1236856314011", "1236810914014", "1236795614017", "1236851814016", "1236759914012", "1235563314029", "1235941714022", "1236754114018", "1236849814017", "1235539314026", "1235559614026", "1235557714023", "1235581114029", "1235547314027", "1236829914015", "1236805914014", "1236719414017", "1236810414011", "1235900614021", "1236652114013", "1235762214025", "1235622314028", "1236686814014", "1236856914019", "1235617914027", "1236849714012", "1236834614011", "1236750514011", "1236760414015", "1236839414010", "1237099314013", "1235532314020", "1237166814018", "1236778814010", "1236781414015", "1236811614014", "1237153914013", "1235937514027", "1236747514019", "1235879214026", "1236368114011", "1235565614028", "1236650914012", "1235596514023", "1235676214020", "1236861514010", "1236346014021", "1237105814015", "1237105914018", "1237110414017", "1237110514011", "1235973514025", "1237110614016", "1237110714010", "1237110814015", "1237096014019", "1237057714028", "1237096314012", "1237097814019", "1237097914013", "1237098014024", "1237098114010", "1237098214015", "1237098314018", "1237098414014", "1237098514019", "1237098614013", "1237098714018", "1236028014020", "1237098814012", "1237098914017", "1237099014018", "1237099114014", "1237099214019", "1237099414018", "1237099514012", "1237099614017", "1237099714011", "1236530414024", "1237099914010", "1237100014010", "1237103414018", "1235519214025", "1236853414015", "1236828414019", "1234661414027", "1236366014018", "1236717514014", "1236672914016", "1236656614010", "1236702614012", "1236027914044", "1236381214017", "1236083414028", "1236083114026", "1237219714010", "1236145514026", "1235919614022", "1236076214023", "1236076414022", "1237221214017", "1237221314011", "1237221414016", "1237221514010", "1235770514028", "1237221614015", "1237034314016", "1235896514025", "1235759514026", "1235885914021", "1235885514023", "1235885414029", "1235885814027", "1235885714022", "1235875114027", "1235875214021", "1235875014022", "1237034914013", "1237035014016", "1235892514020", "1235892414026", "1235892214027", "1237035114010", "1235894414023", "1237035214015", "1237035314018", "1235883814028", "1235883514026", "1235883714025", "1235883914024", "1235883614020", "1236094014023", "1235872514024", "1235885614036", "1237036214019", "1237036314013", "1235890814027", "1235890614036", "1235890514023", "1235890414029", "1235890214028", "1235891014024", "1235890714022", "1235581414030", "1235878714025", "1237022114011", "1237087414012", "1237087514017", "1237087614011", "1235957914021", "1236771814023", "1237087714016", "1235936114025", "1235944314025", "1237089214010", "1237089314015", "1235951114023", "1235931214021", "1237088214017", "1237088314011", "1237088414016", "1235696014036", "1237088514010", "1237088614015", "1237088714018", "1234920014024", "1237088814014", "1237114314017", "1237114414011", "1237153814019", "1237154114010", "1237154214015", "1236362914016", "1237154314018", "1237154414014", "1235626614036", "1237154514019", "1237154614013", "1236363514011", "1236364014012", "1235553414033", "1237072214017", "1237072314011", "1235937614021", "1235942414022", "1235942614021", "1235943414026", "1235942214023", "1235943714028", "1235944214020", "1235936714022", "1235944614029", "1235937814020", "1235938114022", "1235936314024", "1235936214028", "1235942114029", "1235942914025", "1235943614025", "1235941914021", "1235942314036", "1235942514027", "1235942014024", "1235941614036", "1235937214023", "1235937114029", "1235944114026", "1235937414022", "1235936914021", "1237072514010", "1235937314036", "1237072814014", "1235900914025", "1237072914019", "1235384214046", "1236997314015", "1235815714025", "1235813114020", "1236997414018", "1236997514014", "1236997614019", "1236997714013", "1235877814026", "1236998114018", "1236359214011", "1235857914024", "1235892914029", "1237015114014", "1235858014027", "1235352814033", "1237015214019", "1237016214012", "1235543114031", "1237017714019", "1235873614022", "1235873414023", "1235873514036", "1235860414024", "1235839714026", "1237026514014", "1235958714026", "1235919814021", "1237085114011", "1237085214016", "1235943914029", "1236356714013", "1236018714024", "1237155614017", "1237155714011", "1237064114011", "1237064214016", "1235909614024", "1237064314010", "1237064414015", "1237064514018", "1235919414023", "1237064614014", "1235919014025", "1237066014014", "1235937014024", "1235943314021", "1237082114010", "1237082214015", "1235942714026", "1234662114035", "1234661914046", "1235637714024", "1235637414020", "1235637514025", "1235637814029", "1235948214025", "1235945414023", "1235945814021", "1235946414027", "1235948414024", "1235946314022", "1235945714027", "1235946114023", "1235948314028", "1235945614022", "1235946214036", "1237092914015", "1237094214010", "1237094314015", "1237056114010", "1237057914010", "1236432314028", "1237058014013", "1235913114036", "1235913314027", "1235523614046", "1235523714032", "1235908714025", "1237058114018", "1237058214012", "1237058314017", "1237058414011", "1237060114017", "1237155814016", "1237155914010", "1236832114028", "1237158014010", "1237158114015", "1235879314020", "1237158214018", "1237158314014", "1237158414019", "1237158514013", "1237158614018", "1237158714012", "1237158814017", "1237158914011", "1237159014014", "1237159214013", "1237159314018", "1237159414012", "1235984514027", "1237159514017", "1235877914020", "1235794814024", "1235778514029", "1236979314016", "1236979414010", "1236989914011", "1236990114010", "1236990214015", "1236990314018", "1237055814019", "1237094414018", "1235946614026", "1235947114027", "1235946514021", "1235945914026", "1235948014026", "1235948514029", "1235947314026", "1235946914028", "1235947214021", "1235946714020", "1235946814025", "1237094714013", "1235944914022", "1236274514024", "1235944514024", "1237095214014", "1237120414015", "1237120514018", "1237120614014", "1237120714019", "1237120814013", "1237120914018", "1236008314036", "1235764414021", "1235759914024", "1236818314024", "1235089814031", "1237159614011", "1235922914029", "1235944014021", "1237161114018", "1236656814036", "1237161314017", "1235195714054", "1236344614013", "1237161514016", "1237161614010", "1237161714015", "1237161814018", "1236804914029", "1235452014026", "1237161914014", "1237162014017", "1237162114011", "1237162214016", "1237162314010", "1237166414018", "1237166614019", "1237166714013", "1237167014015", "1237167114018", "1237167214014", "1237167714017", "1236379614024", "1237168114013", "1237173614016", "1235922814024", "1236272914025", "1235917614025", "1237060814019", "1235595914036", "1235922514020", "1235876914035", "1235919714027", "1235907414036", "1235911014026", "1235911114020", "1236344714026", "1237121014010", "1236007914021", "1237121114015", "1237121214018", "1235151014039", "1237121314014", "1235968814029", "1237012714010", "1237012814015", "1236428814026", "1237012914018", "1236053514028", "1237173714010", "1235069914038", "1236012414029", "1237176514012", "1237161414011", "1237166514014", "1237166914012", "1237167314019", "1235885314032", "1236027314020", "1235459614037", "1237208014017", "1237208114011", "1236861814022", "1237209414019", "1237209514013", "1235332914023", "1237209714012", "1237210214015", "1237210314018", "1236384714029", "1237210814012", "1236770914024", "1235941314032", "1235655714023", "1237010714013", "1235849814029", "1235849914023", "1237010814018", "1235830014021", "1235847414023", "1237011414013", "1235141514033", "1234761214017", "1237212114018", "1237212214012", "1237212314017", "1237212414011", "1237212514016", "1236074214026", "1236076514027", "1237213214016", "1236072714021", "1237213314010", "1237213414015", "1236569214022", "1237213914018", "1237214014010", "1236844414029", "1237214114015", "1237214214018", "1237228714015", "1237228814018", "1235636914028", "1235628114022", "1235392814052", "1236081814020", "1237229914018", "1237230014020", "1237230114017", "1235910114027", "1236085014029", "1237231414014", "1237231814012", "1237231914017", "1237232514012", "1237232614017", "1237232714011", "1236980614015", "1236981114016", "1236981214010", "1236981314015", "1235820614020", "1235388714027", "1235908614020", "1237052614019", "1235894114028", "1237052714013", "1237052814018", "1235874314022", "1235900214023", "1235943114030", "1237232814016", "1236360214025", "1236359014012", "1235736814022", "1236882114012", "1236882214017", "1236882814014", "1235741614023", "1235741514029", "1235741714036", "1236885014019", "1236885114013", "1236913314015", "1236913414018", "1235764314027", "1235888114026", "1235900514027", "1235900814020", "1235900314036", "1235901014036", "1235900014024", "1235900114029", "1235889014025", "1235901914029", "1237046314011", "1237046414016", "1236409814023", "1237116314014", "1237116414019", "1237116514013", "1237116614018", "1237116714012", "1236865214028", "1237116814017", "1237116914011", "1236010514034", "1235968514025", "1236803214023", "1237117014014", "1235968114027", "1237004814014", "1235772314036", "1237004914019", "1235222814031", "1235840014028", "1235742414036", "1236906314018", "1235601414024", "1236331014017", "1235707114028", "1235886514027", "1237173414017", "1237146814011", "1237122014014", "1236965914010", "1236867314013", "1235873914026", "1237125614012", "1235627114029", "1236878514014", "1235877614027", "1236878614019", "1236878714013", "1236878814018", "1236878914012", "1236879014015", "1236879114018", "1236879214014", "1236879314019", "1236879414013", "1236879514018", "1236879614012", "1236879714017", "1236571614028", "1236879814011", "1236879914016", "1236880014010", "1236880114015", "1236880214018", "1236880314014", "1235570114027", "1235692914024", "1236747114010", "1236866114010", "1234655814021", "1235718614024", "1236866414014", "1236867114014", "1236867414018", "1236867814016", "1236867914010", "1236869014017", "1236869114011", "1236869514018", "1236869714019", "1236870214011", "1236866714018", "1236866814012", "1236866914017", "1236867014018", "1235636614026", "1236867614017", "1236867714011", "1236868414011", "1236868514016", "1236868614010", "1236869414015", "1236869614014", "1236869914018", "1236870014012", "1236866614013", "1236868014013", "1236868114018", "1236868314017", "1236868814018", "1236866514019", "1236868914014", "1236867214019", "1236869214016", "1236908914012", "1236489414020", "1236909014015", "1236909114018", "1236909214014", "1236909314019", "1236830014036", "1235762014026", "1235762114020", "1236909614012", "1236909714017", "1236900014012", "1236912714018", "1236912814014", "1236912914019", "1236869314010", "1236870114017", "1235734614026", "1236874014017", "1235765214026", "1236899614019", "1236899714013", "1236899814018", "1236899914012", "1236963714014", "1236963814019", "1236963914013", "1236964014016", "1236964114010", "1236964214015", "1236964614013", "1236411314028", "1236410314026", "1235564514021", "1235950414023", "1237009214015", "1236076714026", "1236411214025", "1235889414023", "1235889514036", "1236253014021", "1235937914025", "1235903014025", "1236362114018", "1237222414018", "1236081714026", "1237223114018", "1236076814020", "1236084514036", "1237223214014", "1237223314019", "1237223414013", "1237223514018", "1237223614012", "1237223714017", "1236410114027", "1236410214021", "1236410414020", "1236410514025", "1236413714025", "1236410614028", "1236410814029", "1236411414024", "1236411614015", "1236411814022", "1235621614028", "1237223814011", "1237223914016", "1236838214026", "1237225014012", "1237225114017", "1237225214011", "1235884614024", "1237039914011", "1237040014016", "1235879014027", "1235815414021", "1235885014020", "1235885114025", "1235884714029", "1235896614028", "1237040114010", "1237040214015", "1236342014027", "1237124814018", "1235543714039", "1237147914018", "1237148114017", "1235874614026", "1235884814023", "1235660614037", "1237149414014", "1236464314021", "1237003214013", "1237003314018", "1237003414012", "1235871214027", "1235597814039", "1237003514017", "1237003714016", "1237067914019", "1237068014011", "1235628214027", "1234760914015", "1235552114036", "1237070714012", "1236761014029", "1237070914011", "1237071014014", "1236928014026", "1237071114019", "1237071214013", "1235516114028", "1237071314018", "1236359314016", "1236359414010", "1236359514015", "1236639814022", "1235941214028", "1235944414028", "1235943814024", "1235907514030", "1234699914048", "1237076914013", "1236359114017", "1237124714013", "1235605814035", "1235706514024", "1235737214029", "1236970714011", "1235637314026", "1235943214027", "1236971414011", "1236971514016", "1236972114011", "1236367714023", "1234621814030", "1235889614022", "1237038414015", "1235861614027", "1236836714013", "1235879114021", "1235871314021", "1237081214011", "1235618114024", "1236330514016", "1237121614018", "1237121714012", "1235196814052", "1237121814025", "1237121914011", "1235708314022", "1235900714026", "1237122114019", "1235900414022", "1237122214013", "1235876514029", "1235925014029", "1235918714023", "1235961314020", "1237122614011", "1235996314023", "1237124614019", "1237124914012", "1237125014015", "1237125114018", "1235598514020", "1237125214014", "1237125314019", "1236357314019", "1237146614012", "1237146714017", "1235638214025", "1234756014026", "1237146914016", "1237147014019", "1235626714022", "1237147114013", "1237147214018", "1237147314012", "1236151714029", "1237147414017", "1237147514011", "1237147614016", "1237147714010", "1235973714024", "1237147814015", "1235536214020", "1235628314021", "1237148014012", "1237148214011", "1237148314016", "1237148414010", "1235874714020", "1237148514015", "1237148614018", "1237148714014", "1237148814019", "1237148914013", "1237149014016", "1237149114010", "1237149214015", "1237149314018", "1237125414013", "1237125514018", "1237125714017", "1237125814011", "1236330214012", "1236331114011", "1236344214015", "1236356914012", "1236373014017", "1236372914014", "1237173114013", "1237173214018", "1237173314012", "1237173514011", "1236051514030", "1235627714026", "1237181514012", "1236053314020", "1236054114025", "1235966714027", "1237181614017", "1236186814026", "1235691514030", "1237181714011", "1237181814016", "1237181914010", "1236053414025", "1235991514032", "1236276314022", "1237191714018", "1237191814014", "1237191914019", "1236009614025", "1236073614020", "1236897914015", "1236898214017", "1235572414044", "1235874214036", "1235874114023", "1237023614018", "1237024414012", "1237024514017", "1237024614011", "1236820914020", "1235872314025", "1235872414028", "1237024814010", "1237024914015", "1235881714036", "1237025014018", "1235877014028", "1237025714018", "1237025914019", "1237026014011", "1235770914036", "1236849514021", "1237026414018", "1236358814023", "1236304014021", "1235882714021", "1235853514021", "1235882614027", "1235878014023", "1235888914022", "1235886414022", "1235886614021", "1235886314036", "1235886914025", "1235886214023", "1237192114016", "1236362614012", "1237196514019", "1237197014018", "1237197214019", "1237197314013", "1237197414018", "1237197514012", "1237197614017", "1236085114023", "1237197714011", "1237197814016", "1237198914014", "1237199014017", "1236067814026", "1236066814022", "1235544914023", "1235190514022", "1237203914018", "1237204014012", "1235222914044", "1236010614020", "1237204214011", "1237204314016", "1237204414010", "1235620914028", "1237182514016", "1237225314016", "1236068214022", "1236068014023", "1236068114036", "1237225414010", "1237009314018", "1237009414014", "1237009514019", "1237030514010", "1235861314023", "1235873714027", "1237030614015", "1236363414017", "1235877714021", "1235603814046", "1237030714018", "1235890314024", "1235896114027", "1235896214021", "1235877314023", "1235872014021", "1235896914023", "1235878614020", "1235467714024", "1235888514024", "1235887814024", "1235888414028", "1235890114025", "1237149514019", "1237149614013", "1237149714018", "1236007414029", "1236891914021", "1237149814012", "1235612414026", "1235606714026", "1237149914017", "1237150014011", "1235941814027", "1237182014013", "1235794914029", "1237192014011", "1236893514012", "1236366514012", "1236672214022", "1236990714018", "1236990814012", "1236990914017", "1236991214019", "1237150114016", "1237150214010", "1237150314015", "1237150414018", "1237150514014", "1237150614019", "1237150714013", "1236331314010", "1237150814018", "1237150914012", "1237151014015", "1237151114018", "1237151214014", "1237151314019", "1237151414013", "1235984714026", "1237151514018", "1237151614012", "1237151714017", "1237151814011", "1235567314023", "1237151914016", "1237152014019", "1237152114013", "1237152214018", "1235889314029", "1237047014011", "1237047614019", "1237047714013", "1237047914012", "1235909814023", "1236931514013", "1236931614018", "1236753414026", "1236363714029", "1236531214029", "1236931914011", "1235896814029", "1234659814026", "1235883414021", "1235874414027", "1235903114028", "1237042314017", "1237042414011", "1237042614010", "1237042714015", "1235778314028", "1235778214025", "1235762314028", "1236940514018", "1236940714017", "1236940814011", "1236940914016", "1236236114020", "1235948614023", "1235778114020", "1236940614020", "1234921614025", "1236966314017", "1236966814018", "1236967514018", "1236965014018", "1236965114014", "1236965214019", "1236965314013", "1236965414018", "1236965514012", "1236965614017", "1236965714011", "1235626414029", "1236965814016", "1236966014013", "1236966114018", "1236966214012", "1236966414011", "1236966514016", "1236966614010", "1236966714015", "1236966914014", "1236967014017", "1236967114011", "1236362414021", "1235741814022", "1236531114024", "1235735914023", "1236887914017", "1236942614018", "1236943214015", "1236943314018", "1236943414014", "1236945214012", "1236949814014", "1235762514029", "1235770814023", "1236950114018", "1235228214018", "1236950214012", "1236950314017", "1236950414011", "1236950614010", "1236950714015", "1236950814018", "1235770414025", "1235772014024", "1235772414022", "1236951314010", "1236951514018", "1235806714020", "1236951614014", "1236951714019", "1236951814013", "1236967314010", "1236967614014", "1235766014020", "1235765114021", "1236967214016"};
        int stPreklicanih = 0;
        for (String s : serijske) {
            boolean preklican = isCertfPreklican(s);
            if (preklican) {
                stPreklicanih++;
                //System.out.println("Certifikat je preklican:" + s);
            }
        }
        System.out.println("Preklicanih:" + stPreklicanih + "/" + serijske.length);
    }

    private boolean isCertfPreklican(String serijskaSt) throws NamingException, CertificateException, MalformedURLException, IOException, CRLException {
        System.out.println("Is certf preklican for: " + serijskaSt);
        List list = ldapTemplateCertificate.search(
                "", "(&(serialNumber=" + serijskaSt + ")(objectClass=person))",
                new AttributesMapper() {
            @Override
            public Object mapFromAttributes(Attributes atrbts) throws NamingException {
                return atrbts.get("userCertificate;binary");
            }
        });

        if (list.isEmpty()) {
            System.out.println("List is empty, certf not preklican.");
            return false;
        }
        if (!list.isEmpty() && list.get(0) == null) {
            System.out.println("List not empty && list.get(0) == null. Certf is preklican");
            return true;
        }
        if (!list.isEmpty() && list.get(0) != null) {
            Attribute atr = (Attribute) list.get(0);
            byte[] bytes = (byte[]) atr.get();
            InputStream in = new ByteArrayInputStream(bytes);
            CertificateFactory certificateFactory = CertificateFactory.getInstance("X509");

            Certificate certificate = certificateFactory.generateCertificate(in);
            X509Certificate cert = (X509Certificate) certificate;
            BigInteger serialNumber = cert.getSerialNumber();
            for (X509CRLEntry entry : getPreklicaniCertifikati()) {
                if (entry.getSerialNumber().equals(serialNumber)) {
                    System.out.println("Certf found in CRL entry. Returning true, certf is preklican.");
                    return true;
                }
            }
        }
        System.out.println("Returning false. Certf not preklican.");
        return false;

    }

    private Set<? extends X509CRLEntry> getPreklicaniCertifikati() throws MalformedURLException, IOException, CertificateException, CRLException {
        if (this.preklicaniCertifikati == null) {
            URL url = new URL("http://www.sigov-ca.gov.si/crl/sigov-ca.crl ");
            URLConnection connection = url.openConnection();
            connection.setDoInput(true);
            connection.setUseCaches(false);
            DataInputStream inStream = new DataInputStream(connection.getInputStream());
            CertificateFactory cf = CertificateFactory.getInstance("X509");
            X509CRL crl = (X509CRL) cf.generateCRL(inStream);
            inStream.close();

            this.preklicaniCertifikati = crl.getRevokedCertificates();
        }

        return this.preklicaniCertifikati;
    }
}
